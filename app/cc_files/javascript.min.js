// TODO actually recognize syntax of TypeScript constructs
CodeMirror.defineMode("javascript",function(a,b){function h(a,b,c){return b.tokenize=c,c(a,b)}function i(a,b){var c=!1,d;while((d=a.next())!=null){if(d==b&&!c)return!1;c=!c&&d=="\\"}return c}function l(a,b,c){return j=a,k=c,b}function m(a,b){var c=a.next();if(c=='"'||c=="'")return h(a,b,n(c));if(/[\[\]{}\(\),;\:\.]/.test(c))return l(c);if(c=="0"&&a.eat(/x/i))return a.eatWhile(/[\da-f]/i),l("number","number");if(/\d/.test(c)||c=="-"&&a.eat(/\d/))return a.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),l("number","number");if(c=="/")return a.eat("*")?h(a,b,o):a.eat("/")?(a.skipToEnd(),l("comment","comment")):b.lastType=="operator"||b.lastType=="keyword c"||/^[\[{}\(,;:]$/.test(b.lastType)?(i(a,"/"),a.eatWhile(/[gimy]/),l("regexp","string-2")):(a.eatWhile(g),l("operator",null,a.current()));if(c=="#")return a.skipToEnd(),l("error","error");if(g.test(c))return a.eatWhile(g),l("operator",null,a.current());a.eatWhile(/[\w\$_]/);var d=a.current(),e=f.propertyIsEnumerable(d)&&f[d];return e&&b.lastType!="."?l(e.type,e.style,d):l("variable","variable",d)}function n(a){return function(b,c){return i(b,a)||(c.tokenize=m),l("string","string")}}function o(a,b){var c=!1,d;while(d=a.next()){if(d=="/"&&c){b.tokenize=m;break}c=d=="*"}return l("comment","comment")}function q(a,b,c,d,e,f){this.indented=a,this.column=b,this.type=c,this.prev=e,this.info=f,d!=null&&(this.align=d)}function r(a,b){for(var c=a.localVars;c;c=c.next)if(c.name==b)return!0}function s(a,b,c,e,f){var g=a.cc;t.state=a,t.stream=f,t.marked=null,t.cc=g,a.lexical.hasOwnProperty("align")||(a.lexical.align=!0);for(;;){var h=g.length?g.pop():d?E:D;if(h(c,e)){while(g.length&&g[g.length-1].lex)g.pop()();return t.marked?t.marked:c=="variable"&&r(a,e)?"variable-2":b}}}function u(){for(var a=arguments.length-1;a>=0;a--)t.cc.push(arguments[a])}function v(){return u.apply(null,arguments),!0}function w(a){var b=t.state;if(b.context){t.marked="def";for(var c=b.localVars;c;c=c.next)if(c.name==a)return;b.localVars={name:a,next:b.localVars}}}function y(){t.state.context={prev:t.state.context,vars:t.state.localVars},t.state.localVars=x}function z(){t.state.localVars=t.state.context.vars,t.state.context=t.state.context.prev}function A(a,b){var c=function(){var c=t.state;c.lexical=new q(c.indented,t.stream.column(),a,null,c.lexical,b)};return c.lex=!0,c}function B(){var a=t.state;a.lexical.prev&&(a.lexical.type==")"&&(a.indented=a.lexical.indented),a.lexical=a.lexical.prev)}function C(a){return function(c){return c==a?v():a==";"?u():v(arguments.callee)}}function D(a){return a=="var"?v(A("vardef"),O,C(";"),B):a=="keyword a"?v(A("form"),E,D,B):a=="keyword b"?v(A("form"),D,B):a=="{"?v(A("}"),L,B):a==";"?v():a=="function"?v(U):a=="for"?v(A("form"),C("("),A(")"),Q,C(")"),B,D,B):a=="variable"?v(A("stat"),H):a=="switch"?v(A("form"),E,A("}","switch"),C("{"),L,B,B):a=="case"?v(E,C(":")):a=="default"?v(C(":")):a=="catch"?v(A("form"),y,C("("),V,C(")"),D,B,z):u(A("stat"),E,C(";"),B)}function E(a){return p.hasOwnProperty(a)?v(G):a=="function"?v(U):a=="keyword c"?v(F):a=="("?v(A(")"),F,C(")"),B,G):a=="operator"?v(E):a=="["?v(A("]"),K(E,"]"),B,G):a=="{"?v(A("}"),K(J,"}"),B,G):v()}function F(a){return a.match(/[;\}\)\],]/)?u():u(E)}function G(a,b){if(a=="operator"&&/\+\+|--/.test(b))return v(G);if(a=="operator"&&b=="?")return v(E,C(":"),E);if(a==";")return;if(a=="(")return v(A(")"),K(E,")"),B,G);if(a==".")return v(I,G);if(a=="[")return v(A("]"),E,C("]"),B,G)}function H(a){return a==":"?v(B,D):u(G,C(";"),B)}function I(a){if(a=="variable")return t.marked="property",v()}function J(a){a=="variable"&&(t.marked="property");if(p.hasOwnProperty(a))return v(C(":"),E)}function K(a,b){function c(d){return d==","?v(a,c):d==b?v():v(C(b))}return function(e){return e==b?v():u(a,c)}}function L(a){return a=="}"?v():u(D,L)}function M(a){return a==":"?v(N):u()}function N(a){return a=="variable"?(t.marked="variable-3",v()):u()}function O(a,b){return a=="variable"?(w(b),e?v(M,P):v(P)):u()}function P(a,b){if(b=="=")return v(E,P);if(a==",")return v(O)}function Q(a){return a=="var"?v(O,C(";"),S):a==";"?v(S):a=="variable"?v(R):v(S)}function R(a,b){return b=="in"?v(E):v(G,S)}function S(a,b){return a==";"?v(T):b=="in"?v(E):v(E,C(";"),T)}function T(a){a!=")"&&v(E)}function U(a,b){if(a=="variable")return w(b),v(U);if(a=="(")return v(A(")"),y,K(V,")"),B,D,z)}function V(a,b){if(a=="variable")return w(b),e?v(M):v()}var c=a.indentUnit,d=b.json,e=b.typescript,f=function(){function a(a){return{type:a,style:"keyword"}}var b=a("keyword a"),c=a("keyword b"),d=a("keyword c"),f=a("operator"),g={type:"atom",style:"atom"},h={"if":b,"while":b,"with":b,"else":c,"do":c,"try":c,"finally":c,"return":d,"break":d,"continue":d,"new":d,"delete":d,"throw":d,"var":a("var"),"const":a("var"),let:a("var"),"function":a("function"),"catch":a("catch"),"for":a("for"),"switch":a("switch"),"case":a("case"),"default":a("default"),"in":f,"typeof":f,"instanceof":f,"true":g,"false":g,"null":g,"undefined":g,NaN:g,Infinity:g};if(e){var i={type:"variable",style:"variable-3"},j={"interface":a("interface"),"class":a("class"),"extends":a("extends"),constructor:a("constructor"),"public":a("public"),"private":a("private"),"protected":a("protected"),"static":a("static"),"super":a("super"),string:i,number:i,bool:i,any:i};for(var k in j)h[k]=j[k]}return h}(),g=/[+\-*&%=<>!?|]/,j,k,p={atom:!0,number:!0,variable:!0,string:!0,regexp:!0},t={state:null,column:null,marked:null,cc:null},x={name:"this",next:{name:"arguments"}};return B.lex=!0,{startState:function(a){return{tokenize:m,lastType:null,cc:[],lexical:new q((a||0)-c,0,"block",!1),localVars:b.localVars,context:b.localVars&&{vars:b.localVars},indented:0}},token:function(a,b){a.sol()&&(b.lexical.hasOwnProperty("align")||(b.lexical.align=!1),b.indented=a.indentation());if(a.eatSpace())return null;var c=b.tokenize(a,b);return j=="comment"?c:(b.lastType=j,s(b,c,j,k,a))},indent:function(a,b){if(a.tokenize==o)return CodeMirror.Pass;if(a.tokenize!=m)return 0;var d=b&&b.charAt(0),e=a.lexical;e.type=="stat"&&d=="}"&&(e=e.prev);var f=e.type,g=d==f;return f=="vardef"?e.indented+(a.lastType=="operator"||a.lastType==","?4:0):f=="form"&&d=="{"?e.indented:f=="form"?e.indented+c:f=="stat"?e.indented+(a.lastType=="operator"||a.lastType==","?c:0):e.info=="switch"&&!g?e.indented+(/^(?:case|default)\b/.test(b)?c:2*c):e.align?e.column+(g?0:1):e.indented+(g?0:c)},electricChars:":{}"}}),CodeMirror.defineMIME("text/javascript","javascript"),CodeMirror.defineMIME("application/json",{name:"javascript",json:!0}),CodeMirror.defineMIME("text/typescript",{name:"javascript",typescript:!0}),CodeMirror.defineMIME("application/typescript",{name:"javascript",typescript:!0});